<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Randers Kommunes budgetværktøjer</title>

    <script src="https://kit.fontawesome.com/db48da8ef4.js" crossorigin="anonymous"></script>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>

    <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/>

    <!-- Template styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
</head>

<body class="ms-font-m ms-welcome ms-Fabric">
  <header class="ms-welcome__header">
    <img width="150" height="150" src="../../assets/logo-filled.png" alt="Randers Kommunes budgetværktøjer" title="Randers Kommunes budgetværktøjer" />
  </header>
  <section id="sideload-msg" class="ms-welcome__main">
    <h2 class="ms-font-xl"></h2>
  </section>
  <main id="app-body" class="ms-welcome__main">

    <div class="topmenu ">
      <i id="tm_skabeloner" class="fa-solid fa-wand-magic topicon fa-lg"></i>
      <i id="tm_tools" class="fa-solid fa-screwdriver-wrench topicon fa-lg"></i>
      <i id="tm_dev" class="fa-solid fa-code topicon fa-lg"></i>
      <i id="tm_about" class="fa-solid fa-question topicon fa-lg"></i>
    </div>
    <div class="wrapper">
      <div id="skabeloner">
        <p class="overskrift"><i class="fa-solid fa-wand-magic icon"></i>Skabeloner</p>
        <p class="overskrift2">1. Vælg dokumenttype </p>
        <select id="dokumentDropdown" class="dropdown" title="dokumentDropdown"></select>
        <select id="dokumentDetaljeDropdown" class="dropdown skjult" title="dokumentDetaljeDropdown"></select>
        <select id="udvalgDropdown" class="dropdown skjult" title="udvalgDropdown"></select>
        <select id="bevillingsområdeDropdown" class="dropdown skjult" title="bevillingsområdeDropdown">Vælg bevillingsområde</select>
        <div id="toolsdiv" class="skjult">
          <p class="overskrift2">2. Værktøjer</p>
          <div role="button" id="skabelon" class="ms-welcome__action ms-Button ms-Button--hero">
            <span class="ms-Button-label"><i class="fa-solid fa-wand-magic icon"></i>Generer skabelon</span>
          </div>
          <div role="button" id="rydAlt" class="ms-welcome__action ms-Button ms-Button--hero">
            <span class="ms-Button-label"><i class="fa-solid fa-eraser icon"></i>Ryd indhold</span>
          </div>
          <div role="button" class="ms-welcome__action ms-Button ms-Button--hero" onClick="window.location.reload();">
            <span class="ms-Button-label"><i class="fa-solid fa-rotate-left icon"></i>Nulstil</span>
          </div>
        </div>
      </div>
      <div id="tools">
        <p class="overskrift"><i class="fa-solid fa-screwdriver-wrench icon"></i>Værktøjer</p>
        <div role="button" id="formatterTabeller" class="ms-welcome__action ms-Button ms-Button--hero">
          <span class="ms-Button-label"><i class="fa-solid fa-table icon"></i>Autoformatter alle tabeller</span>
        </div>
        <div role="button" id="rydAltDev" class="ms-welcome__action ms-Button ms-Button--hero">
          <span class="ms-Button-label"><i class="fa-solid fa-eraser icon"></i>Ryd indhold</span>
        </div>
        <div role="button" id="rydAlt" class="ms-welcome__action ms-Button ms-Button--hero" onClick="window.location.reload();">
          <span class="ms-Button-label"><i class="fa-solid fa-rotate-left icon"></i>Nulstil</span>
        </div>
      </div>
      <div id="dev">
        <p class="overskrift"><i class="fa-solid fa-code icon"></i>Udviklerværktøjer</p>
        <div role="button" id="loadContentControls" class="ms-welcome__action ms-Button ms-Button--hero">
          <span class="ms-Button-label">Console log content controls</span>
        </div>
        <div role="button" id="rydAltDev" class="ms-welcome__action ms-Button ms-Button--hero">
          <span class="ms-Button-label"><i class="fa-solid fa-eraser icon"></i>Ryd indhold</span>
        </div>
        <div role="button" id="rydAlt" class="ms-welcome__action ms-Button ms-Button--hero" onClick="window.location.reload();">
          <span class="ms-Button-label"><i class="fa-solid fa-rotate-left icon"></i>Nulstil</span>
        </div>
      </div>
      <div id="about">
        <p class="overskrift"><i class="fa-solid fa-question icon"></i>Om</p>
      </div>
    </div>
  </main>
</body>

<script>
let dropdownDokument = document.getElementById('dokumentDropdown');
dropdownDokument.length = 0;
let defaultOptionDokument = document.createElement('option');
defaultOptionDokument.text = 'Vælg dokument';
dropdownDokument.add(defaultOptionDokument);
dropdownDokument.selectedIndex = 0;

let dropdownUdvalg = document.getElementById('udvalgDropdown');
dropdownUdvalg.length = 0;   
let defaultOptionUdvalg = document.createElement('option');
defaultOptionUdvalg.text = 'Vælg udvalg';
dropdownUdvalg.add(defaultOptionUdvalg);
dropdownUdvalg.selectedIndex = 0;

const dokumentURL = './assets/dokumenttype.json';
const organisationURL = './assets/organisation.json';
  
/* Populerer dokumentdropdown */
fetch(dokumentURL)  
  .then(  
    function(response) {  
      responseJSON=response.json();
      responseJSON.then(function(data) {  
        let option;
    
        for (let i = 0; i < data.length; i++) {
          option = document.createElement('option');
            option.text = data[i].type;
            dropdownDokument.add(option); 
        }    
      });  
    }  
  )  

  /* Populerer udvalgdropdown */
fetch(organisationURL)  
  .then(  
    function(response) {  
      responseJSON=response.json();
      responseJSON.then(function(data) {  
        let option;
    
        for (let i = 0; i < data.length; i++) {
          option = document.createElement('option');
          option.text = data[i].udvalg;
          dropdownUdvalg.add(option); 
        }    
      });  
    }  
  )  

/* Populerer dokumentdetaljadropdown */
dokumentDropdown.addEventListener("change", e => {
  const valgtDokument = dropdownDokument.options[dropdownDokument.selectedIndex].text;

  dropdownDokumentDetalje = document.getElementById('dokumentDetaljeDropdown');
  dropdownDokumentDetalje.style.display = "block";

  fetch(dokumentURL)  
    .then(  
      function(response) {  

        responseJSON=response.json();
        responseJSON.then(function(data) {  
          let option;
          
          /* Budgetopfølgning */ 
          if (dropdownDokument.selectedIndex==1) {

            let defaultOptionDokumentDetalje = document.createElement('option');
            defaultOptionDokumentDetalje.text = 'Vælg dato'; 
            dropdownDokumentDetalje.add(defaultOptionDokumentDetalje);
            dropdownDokumentDetalje.selectedIndex = 0;

            for (let i = 0; i < data[0].undertype.length; i++) {
              option = document.createElement('option');
              option.text = data[0].undertype[i];
              dropdownDokumentDetalje.add(option); 
            }   
          }  
        });  
      }  
    )  
});

dokumentDetaljeDropdown.addEventListener("change", e => {
  document.getElementById('udvalgDropdown').style.display="block";
});

udvalgDropdown.addEventListener("change", e => {
  document.getElementById('toolsdiv').style.display="block";
});

function setDisplay(elementIdToShow) {
  const elements = ['skabeloner', 'tools', 'dev', 'about'];

  elements.forEach((elementId) => {
    const displayStyle = elementId === elementIdToShow ? 'block' : 'none';
    document.getElementById(elementId).style.display = displayStyle;
  });
}

tm_skabeloner.addEventListener("click", () => {
  setDisplay('skabeloner');
});

tm_tools.addEventListener("click", () => {
  setDisplay('tools');
});

tm_dev.addEventListener("click", () => {
  setDisplay('dev');
});

tm_about.addEventListener("click", () => {
  setDisplay('about');
});
  

  

const valgtBevillingsområde = document.getElementById("valgtBevillingsområde");
    

</script>


</html>

